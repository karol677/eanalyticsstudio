<!doctype html>
<html lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Take Our Measure</title>
  <meta name="description" content="A short performance measure across stress coping, performance, imagery ability, resilience, and technique." />

  <style>
    :root{
      --bg: #070A0F;
      --bg2:#0B1020;
      --panel: rgba(255,255,255,0.06);
      --panel2: rgba(255,255,255,0.08);
      --line: rgba(255,255,255,0.10);
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.70);
      --muted2: rgba(255,255,255,0.55);
      --accent: #A7B6FF;
      --accent2:#7FE1C7;
      --radius: 22px;
      --radius2: 30px;
      --max: 980px;
      --shadow: 0 18px 60px rgba(0,0,0,0.55);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1200px 700px at 18% 10%, rgba(167,182,255,0.12), transparent 55%),
                  radial-gradient(900px 600px at 82% 18%, rgba(127,225,199,0.10), transparent 60%),
                  linear-gradient(180deg, var(--bg), var(--bg2));
      color:var(--text);
      line-height:1.6;
    }
    a{color:inherit; text-decoration:none}
    a:hover{color:var(--accent)}
    .wrap{max-width:var(--max); margin:0 auto; padding:0 18px;}
    header{
      position:sticky; top:0; z-index:20;
      backdrop-filter: blur(14px);
      background: rgba(7,10,15,0.70);
      border-bottom:1px solid var(--line);
    }
    .nav{
      display:flex; align-items:center; justify-content:space-between; gap:16px;
      padding:14px 0;
    }
    .brand{display:flex; gap:10px; align-items:baseline; font-weight:650; letter-spacing:0.2px;}
    .brand small{color:var(--muted2); font-weight:520; letter-spacing:0.10em; text-transform:uppercase; font-size:0.72rem;}
    .btn{
      display:inline-flex; align-items:center; justify-content:center; gap:10px;
      padding:10px 14px; border-radius:999px;
      border:1px solid var(--line);
      background: rgba(255,255,255,0.04);
      color: var(--text);
      transition: transform 140ms ease, background 140ms ease, border-color 140ms ease;
      white-space:nowrap;
      cursor:pointer;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,0.06);
      border-color: rgba(167,182,255,0.35);
    }
    .btn.primary{
      border-color: rgba(167,182,255,0.45);
      background: rgba(167,182,255,0.10);
    }
    main{padding:34px 0 70px;}
    .kicker{
      color: var(--muted2);
      text-transform: uppercase;
      letter-spacing: 0.14em;
      font-size: 0.78rem;
      margin-bottom: 12px;
    }
    h1{margin:0 0 10px; font-size: clamp(1.8rem, 3.2vw, 2.5rem); letter-spacing:-0.4px; line-height:1.15;}
    h2{margin:0 0 10px; font-size:1.2rem; letter-spacing:-0.2px;}
    p{margin:0 0 12px; color:var(--muted); max-width:75ch;}
    .card{
      background: var(--panel);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
    }
    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 14px;
      margin-top: 16px;
    }
    .domain{
      border:1px solid var(--line);
      border-radius: var(--radius);
      background: rgba(255,255,255,0.04);
      padding: 16px;
    }
    .domain-head{
      display:flex; align-items:baseline; justify-content:space-between; gap:10px;
      margin-bottom: 10px;
    }
    .domain-title{font-weight:650; letter-spacing:-0.1px;}
    .domain-note{color:var(--muted2); font-size:0.92rem;}
    .q{
      border-top:1px solid rgba(255,255,255,0.08);
      padding-top: 12px;
      margin-top: 12px;
    }
    .q:first-of-type{border-top:none; padding-top:0; margin-top:0;}
    .q label{
      display:block;
      color: var(--text);
      font-size: 0.98rem;
      margin-bottom: 8px;
    }
    .scale{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items:center;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,0.12);
      background: rgba(255,255,255,0.03);
      color: var(--muted);
      user-select:none;
    }
    input[type="radio"]{accent-color: var(--accent);}
    .help{
      margin-top: 10px;
      color: var(--muted2);
      font-size: 0.95rem;
    }
    .actions{
      display:flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items:center;
      justify-content: space-between;
      margin-top: 14px;
    }
    .left-actions{display:flex; gap:12px; flex-wrap:wrap;}
    .error{
      color: #ffb4b4;
      background: rgba(255,180,180,0.06);
      border: 1px solid rgba(255,180,180,0.18);
      padding: 10px 12px;
      border-radius: 14px;
      margin-top: 12px;
      display:none;
    }
    footer{
      border-top:1px solid var(--line);
      padding: 18px 0 40px;
      color: var(--muted2);
      font-size: 0.92rem;
    }
    @media (max-width: 720px){
      .actions{flex-direction:column; align-items:flex-start;}
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="nav">
        <a class="brand" href="index.html" aria-label="Back to homepage">
          <span>Performance Measure</span>
          <small>Data × Psychology</small>
        </a>
        <div class="left-actions">
          <a class="btn" href="index.html#about">About</a>
          <a class="btn" href="index.html#contact">Contact</a>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="wrap">
      <div class="card">
        <div class="kicker">Baseline self-assessment</div>
        <h1>Take our measure</h1>
        <p>
          Rate each statement from <strong>1</strong> (strongly disagree) to <strong>5</strong> (strongly agree).
          This is an exploratory snapshot to support reflection and future tracking.
        </p>
        <p class="help">
          Your report will open in a new page, showing domain scores and an overall score. You can download it as a PDF.
        </p>

        <div class="error" id="errorBox" role="alert"></div>

        <form id="measureForm" class="grid" novalidate>
          <!-- Domains will be injected here -->
        </form>

        <div class="actions">
          <div class="left-actions">
            <button class="btn primary" type="button" id="submitBtn">Generate report</button>
            <button class="btn" type="button" id="resetBtn">Reset</button>
          </div>
          <span class="help">Estimated time: ~2 minutes</span>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <div class="wrap">
      <small>© <span id="year"></span> Performance Measurement Platform. Exploratory measurement (not diagnosis).</small>
    </div>
  </footer>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();

    // --- 15 items (3 per domain) ---
    const DOMAINS = [
      {
        key: "stressCoping",
        title: "Stress coping",
        note: "How you respond under pressure.",
        items: [
          "Under pressure, I can settle my attention and return to the task.",
          "When setbacks happen, I regain composure quickly.",
          "I have a reliable strategy for managing performance-related stress."
        ]
      },
      {
        key: "performance",
        title: "Performance",
        note: "Execution and consistency.",
        items: [
          "I can execute key skills consistently in demanding conditions.",
          "My performance reflects my preparation more often than chance.",
          "I can maintain quality when the environment becomes unpredictable."
        ]
      },
      {
        key: "imageryAbility",
        title: "Imagery ability",
        note: "Vividness and control of mental images.",
        items: [
          "I can generate clear mental images of performance situations.",
          "My mental imagery includes realistic sensations (e.g., timing, feel, environment).",
          "I can control my imagery to rehearse specific details when needed."
        ]
      },
      {
        key: "resilience",
        title: "Resilience",
        note: "Adaptation and persistence over time.",
        items: [
          "I stay engaged with my goals even when progress is slow.",
          "I adapt quickly when plans change.",
          "I can learn from difficult experiences without losing direction."
        ]
      },
      {
        key: "technique",
        title: "Technique",
        note: "Skill clarity and technical discipline.",
        items: [
          "I know exactly what technical cues matter most for my performance.",
          "I can make small technical adjustments without overthinking.",
          "My technique remains stable even when fatigue increases."
        ]
      }
    ];

    const form = document.getElementById("measureForm");
    const errorBox = document.getElementById("errorBox");

    function createScale(name){
      const wrap = document.createElement("div");
      wrap.className = "scale";

      const anchors = document.createElement("div");
      anchors.className = "help";
      anchors.style.margin = "0 0 6px";
      anchors.textContent = "1 = strongly disagree … 5 = strongly agree";

      // return scale only (anchors shown once per domain)
      for(let v=1; v<=5; v++){
        const chip = document.createElement("label");
        chip.className = "chip";
        chip.innerHTML = `<input type="radio" name="${name}" value="${v}" required /> ${v}`;
        wrap.appendChild(chip);
      }
      return { anchors, scale: wrap };
    }

    function renderForm(){
      form.innerHTML = "";
      DOMAINS.forEach((d, di) => {
        const domain = document.createElement("section");
        domain.className = "domain";
        domain.setAttribute("aria-labelledby", `domain-${d.key}`);

        const head = document.createElement("div");
        head.className = "domain-head";
        head.innerHTML = `
          <div>
            <div class="domain-title" id="domain-${d.key}">${d.title}</div>
            <div class="domain-note">${d.note}</div>
          </div>
          <div class="domain-note">3 items</div>
        `;
        domain.appendChild(head);

        d.items.forEach((text, i) => {
          const q = document.createElement("div");
          q.className = "q";
          const qName = `${d.key}_q${i+1}`;

          const label = document.createElement("label");
          label.setAttribute("for", `${qName}_1`);
          label.textContent = text;

          const { anchors, scale } = createScale(qName);
          // attach ids for accessibility (first radio in group)
          const firstRadio = scale.querySelector("input");
          if (firstRadio) firstRadio.id = `${qName}_1`;

          q.appendChild(label);

          if (i === 0){
            q.appendChild(anchors);
          }

          q.appendChild(scale);
          domain.appendChild(q);
        });

        form.appendChild(domain);
      });
    }

    function getResponses(){
      const fd = new FormData(form);
      const responses = {};
      DOMAINS.forEach(d => {
        responses[d.key] = [];
        for(let i=1;i<=3;i++){
          const v = fd.get(`${d.key}_q${i}`);
          responses[d.key].push(v ? Number(v) : null);
        }
      });
      return responses;
    }

    function validateAll(responses){
      const missing = [];
      DOMAINS.forEach(d => {
        responses[d.key].forEach((v, idx) => {
          if (v === null) missing.push(`${d.title} Q${idx+1}`);
        });
      });
      return missing;
    }

    function mean(arr){
      const nums = arr.filter(x => typeof x === "number");
      return nums.reduce((a,b)=>a+b,0) / nums.length;
    }

    function computeScores(responses){
      const domainScores = {};
      DOMAINS.forEach(d => {
        domainScores[d.key] = mean(responses[d.key]); // 1..5
      });
      const overall = mean(Object.values(domainScores));
      return { domainScores, overall };
    }

    function showError(msg){
      errorBox.textContent = msg;
      errorBox.style.display = "block";
      errorBox.scrollIntoView({behavior:"smooth", block:"center"});
    }

    function clearError(){
      errorBox.style.display = "none";
      errorBox.textContent = "";
    }

    function saveAndOpenReport(payload){
      sessionStorage.setItem("pm_report_v1", JSON.stringify(payload));
      // open report in a new tab/page
      window.open("report.html", "_blank", "noopener,noreferrer");
    }

    document.getElementById("submitBtn").addEventListener("click", () => {
      clearError();
      const responses = getResponses();
      const missing = validateAll(responses);
      if (missing.length){
        showError(`Please answer all items. Missing: ${missing.slice(0,6).join(", ")}${missing.length>6 ? " …" : ""}`);
        return;
      }

      const { domainScores, overall } = computeScores(responses);
      const now = new Date();
      const payload = {
        version: "v1",
        createdAtISO: now.toISOString(),
        createdAtDisplay: now.toLocaleString("en-GB", { dateStyle:"medium", timeStyle:"short" }),
        scale: { min: 1, max: 5 },
        domains: DOMAINS.map(d => ({ key: d.key, title: d.title, note: d.note })),
        responses,
        domainScores,
        overall
      };
      saveAndOpenReport(payload);
    });

    document.getElementById("resetBtn").addEventListener("click", () => {
      clearError();
      form.reset();
      window.scrollTo({top:0, behavior:"smooth"});
    });

    renderForm();
  </script>
</body>
</html>